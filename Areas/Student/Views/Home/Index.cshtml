@using TadrousManassa.Areas.Student.Models
@model LecturesBySemesterVM


<div class="text-center">
    <h1 class="display-4">Welcome</h1>
</div>

<section class="slider_section ">
    <div id="customCarousel1" class="carousel slide" data-ride="carousel">
        <div class="container">
            @if (Model.TopStudentsScores != null && Model.TopStudentsScores.Any())
            {
                <h3 class="text-center mb-4">🏆 Top Students</h3>
                <table class="table leaderboard-table text-center">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Student</th>
                            <th>Score</th>
                        </tr>
                    </thead>
                    <tbody>
                        @for (int i = 0; i < Model.TopStudentsScores.Count; i++)
                        {
                            var student = Model.TopStudentsScores[i];
                            string rowClass = i switch
                            {
                                0 => "gold-row",
                                1 => "silver-row",
                                2 => "bronze-row",
                                _ => ""
                            };

                            <tr class="@rowClass">
                                <td>@(i + 1)</td>
                                <td>@student.StudentName</td>
                                <td>@student.TotalScore</td>
                            </tr>
                        }
                    </tbody>
                </table>

            }
            else
            {
                <p class="text-muted text-center">No scores available yet.</p>
            }
        </div>

    </div>
</section>


<!-- service section -->
<div>
    <section class="service_section layout_padding">
        <div class="service_container">
            <div class="container ">
                <div class="heading_container heading_center">
                    <h2>
                        <span>Why join us?</span>
                    </h2>
                </div>
                <div class="row">
                    <div class="col-md-4 ">
                        <div class="box ">
                            <div class="img-box">
                                <img src="~/images/quiz.gif" alt="">
                            </div>
                            <div class="detail-box">
                                <h5>
                                    Quizzes
                                </h5>
                                <p>
                                    After every lesson, there’s always a quiz to test your level and make sure you’ve understood the material.
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 ">
                        <div class="box ">
                            <div class="img-box">
                                <img src="~/images/book.gif" alt="">
                            </div>
                            <div class="detail-box">
                                <h5>
                                    Lots of Practice
                                </h5>
                                <p>
                                    We’ll solve together every question from external books, covering all levels of difficulty.
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 ">
                        <div class="box ">
                            <div class="img-box">
                                <img src="~/images/teacher.gif" alt="">
                            </div>
                            <div class="detail-box">
                                <h5>
                                    Simplifying Knowledge
                                </h5>
                                <p>
                                    Detailed explanations for every part of the curriculum in a simple and enjoyable way.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<div class="text-center mb-4">
    <h1 class="display-4 text-primary fw-bold">📚 Lectures</h1>
</div>

<div class="container">
    <!-- Semester Cards Section -->
    <div class="row g-4">
        @foreach (var semester in Model.LecturesOfSemestersByUnits.Keys)
        {
            var lectureCount = Model.LecturesOfSemestersByUnits[semester].Count;
            <div class="col-md-4">
                <div class="semester-card shadow-sm" data-semester="@semester">
                    <h4 class="semester-title">Term: @semester</h4>
                    <p class="lecture-count">
                        <span class="badge bg-info">@lectureCount</span>
                        lecture@(lectureCount > 1 ? "s" : "")
                    </p>
                </div>
            </div>
        }
    </div>

    <!-- Lecture List Section -->
    <div class="mt-4">
        @foreach (var semester in Model.LecturesOfSemestersByUnits.Keys)
        {
            <div class="lecture-group" data-semester="@semester" style="display:none;">
                @foreach (var lecture in Model.LecturesOfSemestersByUnits[semester])
                {
                    <div class="lecture-row shadow-sm" data-lecture-id="@lecture.Id">
                        <div class="lecture-info">
                            🎤 <strong>@lecture.Name</strong>
                        </div>
                        <div class="lecture-actions">
                            @if (!lecture.IsPurchased)
                            {
                                <form method="post" action="@Url.Action("LecturePurchasing", "Lecture")" class="d-inline-flex align-items-center">
                                    <input type="hidden" name="lectureId" value="@lecture.Id" />
                                    <input type="text" id="code-@lecture.Id" name="code" class="form-control form-control-sm me-2 code-input" placeholder="Enter code..." />
                                    <button type="submit" class="btn btn-success btn-sm buy-btn" data-lecture-id="@lecture.Id">Buy 🎟</button>
                                </form>
                            }
                            else
                            {
                                <form method="get" action="@Url.Action("LectureDetails", "Lecture")" class="d-inline">
                                    <input type="hidden" name="lectureId" value="@lecture.Id" />
                                    <button type="submit" class="btn btn-primary btn-sm go-btn">Go 🚀</button>
                                </form>
                            }
                        </div>
                    </div>
                }
            </div>
        }
    </div>
</div>


@section Scripts {
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        $(document).ready(function () {

            // Handle semester card clicks
            $('.semester-card').click(function () {
                var selectedSemester = $(this).data('semester');
                var targetGroup = $('.lecture-group[data-semester="' + selectedSemester + '"]');

                // Remove active class from all semester cards
                $('.semester-card').removeClass('active-semester');

                // If the clicked group is already visible -> collapse it
                if (targetGroup.is(':visible')) {
                    targetGroup.slideUp(400);
                } else {
                    // Hide all groups with animation
                    $('.lecture-group:visible').slideUp(400);

                    // Add highlight to selected semester card
                    $(this).addClass('active-semester');

                    // Show selected group with animation
                    targetGroup.slideDown(400);
                }
            });

        });
    </script>
    <style>
        /* Highlight selected semester card */
        
    </style>
}


<!-- jQery -->
<script type="text/javascript" src="~/lib/jquery/dist/jquery.js"></script>
<script type="text/javascript" src="~/lib/jquery/dist/jquery.min.js"></script>
<!-- popper js -->
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<!-- bootstrap js -->
<script type="text/javascript" src="~/lib/bootstrap/dist/js/bootstrap.js"></script>
<!-- owl slider -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
<!-- custom js -->
<script type="text/javascript" src="~/js/custom.js"></script>
<!-- Google Map -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCh39n5U-4IoWpsVGUHWdqB6puEkhRLdmI&callback=myMap"></script>
<!-- End Google Map -->
<link rel="stylesheet" href="~/css/site.css" />
<link rel="stylesheet" href="~/css/bootstrap.css" />
<link rel="stylesheet" href="~/css/responsive.css" />
<link rel="stylesheet" href="~/css/style.css" />
<link rel="stylesheet" href="~/css/units.css">
<link rel="stylesheet" href="~/css/fun-layout.css" />

